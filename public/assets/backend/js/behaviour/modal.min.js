(function(){function a(t,a,e,n){var r=t.find(".modal-body .nav-tabs>li");t.find(".modal-footer").removeClass("hidden");if(n==null)n=[0];r.on("click",function(){var a=r.index(this),e=false;for(var i=0;i<n.length;i++){if(a==n[i]){e=true;break}}if(e){t.find(".modal-footer").removeClass("hidden")}else{t.find(".modal-footer:not(.hidden)").addClass("hidden")}});t.find("table[data-page-size]").each(function(){l($(this),a,e)})}function l(t,n,r){if(!t||t.length<1)return;var f=t.data(),e=null;if(r){if(f.ajaxList&&f.ajaxList in r)r[f.ajaxList](t);if("switchPage"in r)e=r["switchPage"];if("pageData"in r)f=typeof r["pageData"]=="function"?r["pageData"](t):r["pageData"]}App.withPagination(f,null);t.after(f.pagination);if(!e){e=function(a){var e={ajaxList:f.ajaxList,page:a};e=$.extend(e,n||{});var i=typeof f["pageUrl"]!="undefined"?f["pageUrl"]:window.location.href;$.get(i,e,function(a){var e=t.parent();e.html(a);l(e.children("table[data-page-size]"),n,r)},"html")}}var a=t.next("ul.pagination");a.find("li > a[page]").on("click",function(){if($(this).closest("li.disabled").length>0)return;e($(this).attr("page"))});a.on("refresh",function(){var a=1;if($(this).data("page")){a=$(this).data("page");$(this).data("page",false)}else{a=$(this).find("li.active > a[page]").data("page")||1}e(a)})}function i(l,d,o,a,s,h){var e=l.data("form-data"),i=d.find("form");i[0].reset();var c=d.find(".langset").length>0,p="";if(c){var t=d.find(".langset > .nav-tabs > li:first");if(!t.hasClass("active")){t.children("a").trigger("click")}p=t.children("a").data("lang")}if(e){for(var n in e){var r=e[n],f=i.find('[name="'+n+'"]:first');if(f.length<1)continue;var g=f.attr("type");switch(f[0].tagName.toLowerCase()){case"input":if(g==="checkbox"||g==="radio"){i.find('[name="'+n+'"][value="'+r+'"]').prop("checked",true)}else{f.val(r)}break;default:f.val(r);break}}}if(a)a(l,d,e,c,p);var u=d.find(".modal-footer .btn-primary");u.off("click").on("click",function(){var a=d.find("form"),i={};a.find("input,select,textarea").each(function(){var a=$(this).attr("name"),e="";switch(this.tagName.toLowerCase()){case"input":if(this.type==="checkbox"||this.type==="radio"){if(!this.checked)return}else if(this.type==="button"){return}e=$(this).val();break;default:e=$(this).val();break}if(a)i[a]=e});var t={data:i,multilingual:c};if(c){if(!h)h="Language";if(!o){var n=h+"["+p+"]";a.find('[name^="'+n+'"]').each(function(){var a=$(this).attr("name"),e=a.replace(n+"[","").replace("]","");t[e]=i[a]})}else{for(var e=0;e<o.length;e++){var r=o[e];t[r]=i[h+"["+p+"]["+r+"]"]}}t.langDefault=p}else{if(!o){for(var f in i){t[f]=i[f]}}else{for(var e=0;e<o.length;e++){var r=o[e];t[r]=i[r]}}}if(s)s(l,d,t)})}function t(a,i,t,n){var r="Language[",f="",l="";if(t){for(var d=0;d<t.length;d++){f+="["+t[d]+"]";if(d==0){l+=t[d]}else{l+="["+t[d]+"]"}}}for(var o in i.data){if(!o.startsWith(r))continue;var s=o.substring(r.length);s=s.substring(0,s.length-1);var h=s.split("][");if(h.length!=2)continue;if(h[0]==i.langDefault)continue;if(n)h[1]=n(h[1]);var c="Language"+f+"["+h[1]+"]",p=a.find('input[type=hidden][name="'+c+'"]');if(p.length>0){p.val(i.data[o]);continue}a.prepend('<input type="hidden" name="'+c+'" value="'+i.data[o]+'" />')}var c=l+"[translate]",p=e.siblings('input[type=hidden][name="'+c+'"]'),g=i.data.forceTranslate?"1":"";if(p.length>0){p.val(g)}else{a.prepend('<input type="hidden" name="'+c+'" value="'+g+'" />')}}App.initModalBody=a;App.initModalBodyPagination=l;App.initModalForm=i;App.updateMultilingualFormByModal=t})();