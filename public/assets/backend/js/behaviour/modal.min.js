(function(){function a(e,a,t,n){var l=e.find(".modal-body .nav-tabs>li");e.find(".modal-footer").removeClass("hidden");if(n==null)n=[0];l.on("click",function(){var a=l.index(this),t=false;for(var i=0;i<n.length;i++){if(a==n[i]){t=true;break}}if(t){e.find(".modal-footer").removeClass("hidden")}else{e.find(".modal-footer:not(.hidden)").addClass("hidden")}});e.find("table[data-page-size]").each(function(){f($(this),a,t)})}function f(e,n,l){if(!e||e.length<1)return;var r=e.data(),t=null;if(l){if(r.ajaxList&&r.ajaxList in l)l[r.ajaxList](e);if("switchPage"in l)t=l["switchPage"];if("pageData"in l)r=typeof l["pageData"]=="function"?l["pageData"](e):l["pageData"]}App.withPagination(r,null);e.after(r.pagination);if(!t){t=function(a){var t={ajaxList:r.ajaxList,page:a};t=$.extend(t,n||{});var i=typeof r["pageUrl"]!="undefined"?r["pageUrl"]:window.location.href;$.get(i,t,function(a){var t=e.parent();t.html(a);f(t.children("table[data-page-size]"),n,l)},"html")}}var a=e.next("ul.pagination");a.find("li > a[page]").on("click",function(){if($(this).closest("li.disabled").length>0)return;t($(this).attr("page"))});a.on("refresh",function(){var a=1;if($(this).data("page")){a=$(this).data("page");$(this).data("page",false)}else{a=$(this).find("li.active > a[page]").data("page")||1}t(a)})}function t(f,d,o,a,s,h){var t=f.data("modal-title"),i=f.data("form-data"),e=d.find("form");var n=d.find(".modal-header h3"),l=n.data("original-title");if(t){if(!l)n.data("original-title",n.html());n.html(t)}else if(l){n.html(l);n.data("original-title",null)}e[0].reset();var c=d.find(".langset").length>0,g="";if(c){var r=d.find(".langset > .nav-tabs > li:first");if(!r.hasClass("active")){r.children("a").trigger("click")}g=r.children("a").data("lang")}if(i){for(var p in i){var u=i[p],v=e.find('[name="'+p+'"]:first');if(v.length<1)continue;var m=v.attr("type");switch(v[0].tagName.toLowerCase()){case"input":if(m==="checkbox"||m==="radio"){e.find('[name="'+p+'"][value="'+u+'"]').prop("checked",true)}else{v.val(u)}break;default:v.val(u);break}}}if(a)a(f,d,i,c,g);var b=d.find(".modal-footer .btn-primary");b.off("click").on("click",function(){var a=d.find("form"),i={};a.find("input,select,textarea").each(function(){var a=$(this).attr("name"),t="";switch(this.tagName.toLowerCase()){case"input":if(this.type==="checkbox"||this.type==="radio"){if(!this.checked)return}else if(this.type==="button"){return}t=$(this).val();break;default:t=$(this).val();break}if(a)i[a]=t});var e={data:i,multilingual:c};if(c){if(!h)h="Language";if(!o){var n=h+"["+g+"]";a.find('[name^="'+n+'"]').each(function(){var a=$(this).attr("name"),t=a.replace(n+"[","").replace("]","");e[t]=i[a]})}else{for(var t=0;t<o.length;t++){var l=o[t];e[l]=i[h+"["+g+"]["+l+"]"]}}e.langDefault=g}else{if(!o){for(var r in i){e[r]=i[r]}}else{for(var t=0;t<o.length;t++){var l=o[t];e[l]=i[l]}}}if(s)s(f,d,e)})}function i(a,t,i,e){var n="Language[",l="",r="";if(i){for(var f=0;f<i.length;f++){l+="["+i[f]+"]";if(f==0){r+=i[f]}else{r+="["+i[f]+"]"}}}for(var d in t.data){if(!d.startsWith(n))continue;var o=d.substring(n.length);o=o.substring(0,o.length-1);var s=o.split("][");if(s.length!=2)continue;if(s[0]==t.langDefault)continue;if(e)s[1]=e(s[1]);var h="Language"+l+"["+s[0]+"]["+s[1]+"]",c=a.find('input[type=hidden][name="'+h+'"]');if(c.length>0){c.val(t.data[d]);continue}a.prepend('<input type="hidden" name="'+h+'" value="'+t.data[d]+'" />')}var h=r+"[translate]",c=a.find('input[type=hidden][name="'+h+'"]'),g="forceTranslate"in t.data?t.data.forceTranslate:"";if(c.length>0){c.val(g)}else{a.prepend('<input type="hidden" name="'+h+'" value="'+g+'" />')}}App.initModalBody=a;App.initModalBodyPagination=f;App.initModalForm=t;App.updateMultilingualFormByModal=i})();