{{- with $.Get `cropImageConfig` -}}
{{- $key := .Get `key` | Default `image` -}}
{{- $kOriginal := .Get `keyOriginal` | Default (printf `%vOriginal` $key) -}}
{{- $subdir := .Get `subdir` -}}
{{- $image := .Get `image` | Default ($.Form $key) -}}
{{- $prefix := .Get `prefix` | Default `noprefix` -}}
<div class="avatar-upload">
<img src="{{$image|Default (AssetsURL `/images/user_128.png`)}}" class="profile-avatar img-thumbnail" onerror="this.src='{{AssetsURL}}/images/user_128.png';" />
<input id="{{$prefix}}-fileupload" data-upload-url="{{BackendUploadURL $subdir}}" data-toggle="cropImage" data-prefix="{{$prefix}}" type="file" name="files[]" accept="image/*">
<input type="hidden" id="{{$prefix}}-image" name="{{$key}}" value="{{$image}}" />
<input type="hidden" id="{{$prefix}}-image-original" name="{{$kOriginal}}" value="{{.Get `imageOriginal` | Default ($.Form $kOriginal)}}" />
<div id="{{$prefix}}-progress" class="overlay"></div>
{{- $.Set `cropImageModalPrefix` $prefix -}}
{{Include "modal_crop_image" $}}
</div>
{{- end -}}